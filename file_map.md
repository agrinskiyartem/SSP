# Карта файлов проекта

Документ помогает быстро найти, где реализованы ключевые функции (cookies, конкурентный доступ и т.д.).

## Cookie и сессии
- `includes/auth.php` — настройки cookie для PHP-сессии, старт сессии, таймаут/регенерация сессии, хранение пользователя в `$_SESSION`.
- `includes/init.php` — инициализация и вызов `handle_session_timeout()`.
- `login.php` — установка cookies `atm_last_role` и `atm_last_user` после входа, автоподстановка последнего логина.
- `operations.php` — сохранение/восстановление фильтров операций в cookie `ops_filters` (на 5 минут).
- `logout.php` — очистка сессии и регенерация id.

## Конкурентный доступ / транзакции
- `withdraw.php` — снятие наличных в транзакции с блокировкой счёта `SELECT ... FOR UPDATE` (защита от гонок).
- `withdraw_unlocked.php` — демонстрация снятия без блокировки (показывает риск гонок).
- `schema.sql` — пример транзакционного сценария и блокировок на уровне БД.
- `report.md` / `design.md` — описание сценариев конкурентного доступа и блокировок.

## Безопасность
- `includes/functions.php` — генерация и проверка CSRF-токена, helpers для редиректа и экранирования.

## AJAX и динамические данные
- `ajax/card_info.php` — API-эндпоинт для получения данных карты/счёта.
- `assets/app.js` — JS-запросы к `ajax/card_info.php` и клиентская валидация суммы.

## Основные страницы/разделы
- `index.php` — стартовая страница приложения.
- `banks.php` — справочник банков.
- `atms.php` — справочник банкоматов.
- `customers.php` — справочник клиентов.
- `cards.php` — справочник карт.
- `withdraw.php` — снятие наличных.
- `operations.php` — журнал операций.
- `analytics.php` — аналитические отчёты.

## Инфраструктура и оформление
- `config/db.php` — параметры подключения к базе данных и создание PDO.
- `includes/header.php` / `includes/footer.php` — общий шаблон страницы.
- `assets/style.css` — стили интерфейса.
- `schema.sql` — структура БД и наполнение демо-данными.
